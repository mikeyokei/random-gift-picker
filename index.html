<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Gift Picker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }
        h1 {
            color: #333;
        }
        #giftDisplay {
            font-size: 18px;
            margin: 20px 0;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            min-height: 50px;
        }
        input, button {
            font-size: 16px;
            padding: 10px;
            margin: 10px 0;
            width: calc(100% - 22px);
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        button {
            background-color: #4CAF50;
            border: none;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #45a049;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Random Gift Picker</h1>
        <input type="text" id="nameInput" placeholder="Enter your name" required>
        <div id="giftDisplay">Enter your name and click the button to pick a random gift!</div>
        <button id="pickButton" onclick="pickRandomGift()">Pick a Gift</button>
    </div>

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.13.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyB1QTxxpjHrDzCsQj23rFxA7rQXcgwqgiU",
    authDomain: "gift-randomizer.firebaseapp.com",
    projectId: "gift-randomizer",
    storageBucket: "gift-randomizer.appspot.com",
    messagingSenderId: "1056233098101",
    appId: "1:1056233098101:web:b2b228a1593d6c2aebe13c",
    measurementId: "G-HPQ9C898SW"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

        const gifts = [
            "Túi Labubu Blind Box",
            "Kẹp giấy Labubu Blind Box",
            "Đồ kẹp polaroid Candy Bear",
            "Miffy 10cm",
            "Miffy Móc chìa khóa",
            "CryBaby Flower Blind Box",
            "Mền tiên cá ariel disney",
            "Poster Brat (fan-made)",
            "Sổ VanGogh Museum",
            "Sổ claude monet",
            "2 tách trà gốm"
        ];

        function pickRandomGift() {
            const name = document.getElementById('nameInput').value.trim();
            if (!name) {
                alert('Please enter your name first!');
                return;
            }

            if (localStorage.getItem('giftPicked')) {
                alert('You have already picked a gift!');
                return;
            }

            firebase.database().ref('pickedGifts').once('value', function(snapshot) {
                let pickedGifts = snapshot.val() || {};
                let availableGifts = gifts.filter(gift => !Object.values(pickedGifts).includes(gift));

                if (availableGifts.length === 0) {
                    alert('Sorry, all gifts have been picked!');
                    return;
                }

                const randomIndex = Math.floor(Math.random() * availableGifts.length);
                const selectedGift = availableGifts[randomIndex];
                const result = `${name} receives ${selectedGift}`;

                firebase.database().ref('pickedGifts').push(selectedGift);

                document.getElementById('giftDisplay').textContent = result;
                localStorage.setItem('giftPicked', 'true');
                localStorage.setItem('selectedGift', result);
                document.getElementById('pickButton').disabled = true;
                document.getElementById('nameInput').disabled = true;
            });
        }

        window.onload = function() {
            if (localStorage.getItem('giftPicked')) {
                const savedResult = localStorage.getItem('selectedGift');
                document.getElementById('giftDisplay').textContent = savedResult;
                document.getElementById('pickButton').disabled = true;
                document.getElementById('nameInput').disabled = true;
            }
        }
    </script>
</body>
</html>
